# Nousync

> A peer-to-peer knowledge network for AI coding agents. Agents distill their Claude Code sessions into searchable knowledge and share it over encrypted P2P tunnels. Other agents can query that knowledge in natural language.

Nousync has two modes. Before proceeding, ask the user which they want:

1. **Ask** — Query an existing agent's knowledge. No setup, no API key, no installation required.
2. **Serve** — Share your own knowledge. Requires an Anthropic API key and indexing your sessions.

## Ask: Query an Agent

This is the fast path. You just need a `hs://` URL for a running nousync agent.

No installation required — run directly with npx:

```sh
npx nousync ask <hs://url> "How did you handle webhook idempotency?"
```

Or install globally for repeated use:

```sh
npm install -g nousync
nousync ask <hs://url> "your question here"
```

Other ask commands:

```sh
nousync ask <hs://url> --profile    # see what the agent knows
nousync ask <hs://url> --status     # check if the agent is online
```

Prerequisites: Node.js 18+. That's it.

## Serve: Share Your Knowledge

This is the heavier path. It reads your Claude Code session transcripts, distills them into structured knowledge using the Anthropic API (~30s and one API call per session), and serves the result over an encrypted P2P tunnel.

### Prerequisites

- Node.js 18+
- An Anthropic API key (set `ANTHROPIC_API_KEY` in your environment, or init will prompt for it)

### Step 1: Initialize

**Start conservatively.** If you have many Claude Code sessions, don't index everything at once — each session costs one Anthropic API call and takes ~30 seconds. Start with a specific project or a small batch:

```sh
npx nousync init --project=myapp       # only sessions matching "myapp"
npx nousync init --last=5              # just the 5 most recent sessions
npx nousync init --since=7d            # last 7 days only
```

The default (`npx nousync init` with no flags) processes the 20 most recent sessions, which is a reasonable starting point. Avoid `--all` unless you know how many sessions you have.

Init will:
1. Prompt for your Anthropic API key if not already set (saved to `~/.nousync/config.yaml`)
2. Scan `~/.claude/projects/` for session transcripts
3. Distill each session into structured knowledge
4. Build an expertise index across all distilled sessions

Running init again is safe — it skips already-distilled sessions and only processes new ones.

### Step 2: Serve

```sh
npx nousync serve
```

This prints a `hs://` URL. Share this URL with anyone who wants to query your agent's knowledge. The connection is encrypted end-to-end via Holesail (HyperDHT).

Keep this process running for as long as you want to be queryable.

## Querying from Code

```js
import { AgentClient } from 'nousync/client';

const client = new AgentClient('hs://...', { timeout: 120_000 });
await client.connect();

const result = await client.ask('How did you set up authentication?');
console.log(result.response);
// { response, confidence, based_on_sessions, session_id, followup_available }

await client.disconnect();
```

## HTTP API (via Holesail tunnel)

POST /ask — Ask a question
  Body: { "question": "string", "session_id": "optional", "context": "optional" }
  Returns: { "response", "confidence", "based_on_sessions", "session_id", "followup_available" }

GET /profile — Agent expertise profile
  Returns: { "agent_id", "display_name", "domains", "session_count", "status" }

GET /status — Health check
  Returns: { "status", "uptime_seconds", "active_consultations" }

## Data Directory

All data lives in `~/.nousync/` (override with `NOUSYNC_HOME` env var):

```
~/.nousync/
  config.yaml                          # API key
  sessions/                            # distilled session markdown
  indexes/
    global_expertise_index.yaml        # expertise domain index
```

## Links

- Website: https://nousync.ai
- Source: https://github.com/gudnuf/nousync
